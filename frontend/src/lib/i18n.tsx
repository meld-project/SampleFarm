"use client"

import { createContext, useCallback, useContext, useEffect, useMemo, useState } from 'react'

type SupportedLang = 'en' | 'zh-CN'

type Messages = Record<string, string>

type I18nContextValue = {
  lang: SupportedLang
  setLang: (lang: SupportedLang) => void
  t: (key: string, params?: Record<string, string | number>) => string
}

const I18nContext = createContext<I18nContextValue | null>(null)

const STORAGE_KEY = 'samplefarm.lang'

const messages: Record<SupportedLang, Messages> = {
  en: {
    // App
    'app.title': 'SampleFarm - Sample Management System',
    'app.description': 'Professional malware sample management and analysis platform',

    // Navigation
    'nav.brand': 'SampleFarm',
    'nav.files': 'Files',
    'nav.files.desc': 'Upload, manage and view sample files',
    'nav.tasks': 'Tasks',
    'nav.tasks.desc': 'Create and monitor analysis tasks',
    'nav.cape': 'CAPE',
    'nav.cape.desc': 'Configure and monitor CAPE sandbox instances',
    'nav.cfg': 'CFG',
    'nav.cfg.desc': 'Configure and monitor CFG analysis instances',
    'nav.api': 'API Docs',
    'nav.api.download': 'Download API Spec',

    // Language
    'lang.en': 'English',
    'lang.zh': '中文',

    // Common Actions
    'common.refresh': 'Refresh',
    'common.create': 'Create',
    'common.edit': 'Edit',
    'common.delete': 'Delete',
    'common.save': 'Save',
    'common.cancel': 'Cancel',
    'common.confirm': 'Confirm',
    'common.close': 'Close',
    'common.search': 'Search',
    'common.filter': 'Filter',
    'common.export': 'Export',
    'common.import': 'Import',
    'common.upload': 'Upload',
    'common.download': 'Download',
    'common.view': 'View',
    'common.details': 'Details',
    'common.settings': 'Settings',
    'common.loading': 'Loading...',
    'common.noData': 'No data available',
    'common.error': 'Error',
    'common.success': 'Success',
    'common.warning': 'Warning',
    'common.info': 'Info',

    // Pages
    'pages.files.title': 'File Management',
    'pages.files.desc': 'Manage and analyze malware sample files',
    'pages.files.upload': 'Upload Files',
    'pages.tasks.title': 'Task Management', 
    'pages.tasks.desc': 'Create and monitor sample analysis tasks',
    'pages.tasks.create': 'Create Task',
    'pages.cape.title': 'CAPE Instance Management',
    'pages.cape.desc': 'Manage and monitor CAPE sandbox instances',
    'pages.cape.create': 'Create Instance',
    'pages.cfg.title': 'CFG Instance Management',
    'pages.cfg.desc': 'Manage and monitor CFG analysis instances',
    'pages.cfg.create': 'Create Instance',

    // Stats
    'stats.totalFiles': 'Total Files',
    'stats.benignFiles': 'Benign Files',
    'stats.maliciousFiles': 'Malicious Files',
    'stats.containerFiles': 'Container Files',
    'stats.storageUsed': 'Storage Used',
    'stats.totalTasks': 'Total Tasks',
    'stats.runningTasks': 'Running',
    'stats.completedTasks': 'Completed',
    'stats.failedTasks': 'Failed',
    'stats.pendingTasks': 'Pending',

    // Status
    'status.pending': 'Pending',
    'status.running': 'Running',
    'status.completed': 'Completed',
    'status.failed': 'Failed',
    'status.cancelled': 'Cancelled',
    'status.paused': 'Paused',
    'status.active': 'Active',
    'status.inactive': 'Inactive',
    'status.online': 'Online',
    'status.offline': 'Offline',
    'status.healthy': 'Healthy',
    'status.unhealthy': 'Unhealthy',

    // File Management
    'files.filename': 'Filename',
    'files.size': 'Size',
    'files.type': 'Type',
    'files.hash': 'Hash',
    'files.uploadTime': 'Upload Time',
    'files.lastModified': 'Last Modified',
    'files.sampleType': 'Sample Type',
    'files.labels': 'Labels',
    'files.source': 'Source',
    'files.malicious': 'Malicious',
    'files.benign': 'Benign',
    'files.unknown': 'Unknown',
    'files.container': 'Container',

    // Task Management
    'tasks.taskId': 'Task ID',
    'tasks.taskName': 'Task Name',
    'tasks.analyzer': 'Analyzer',
    'tasks.priority': 'Priority',
    'tasks.progress': 'Progress',
    'tasks.createdAt': 'Created At',
    'tasks.updatedAt': 'Updated At',
    'tasks.duration': 'Duration',
    'tasks.samples': 'Samples',
    'tasks.results': 'Results',

    // Upload Dialog
    'upload.title': 'Upload Files',
    'upload.dragDrop': 'Drag and drop files here, or click to select',
    'upload.dragActive': 'Release to upload',
    'upload.selectFiles': 'Select Files',
    'upload.metadata': 'Metadata',
    'upload.sampleType': 'Sample Type',
    'upload.labels': 'Labels',
    'upload.source': 'Source',
    'upload.passwords': 'Passwords',
    'upload.uploading': 'Uploading...',
    'upload.success': 'File uploaded successfully: {filename}',
    'upload.failed': 'Upload failed: {error}',
    'upload.fileInfo': 'File Information',
    'upload.sampleTypeRequired': 'Sample Type *',
    'upload.malicious': 'Malicious',
    'upload.benign': 'Benign',
    'upload.sourceLabel': 'Source',
    'upload.sourcePlaceholder': 'Email attachment, download link, etc.',
    'upload.labelsLabel': 'Labels',
    'upload.labelsPlaceholder': 'Enter labels, separated by commas',
    'upload.zipPassword': 'ZIP Password (Optional)',
    'upload.zipPasswordPlaceholder': 'If this is a password-protected ZIP file',
    'upload.selectedFiles': 'Selected Files ({count})',
    'upload.clear': 'Clear',
    'upload.pending': 'Pending',
    'upload.fileTooLarge': 'File "{filename}" is too large: {size} MB, maximum allowed 1024 MB',
    'upload.fileRejected': 'File "{filename}" rejected: {error}',
    'upload.noFiles': 'No files to upload',
    'upload.supportedFormats': 'Supports single files or ZIP archives, maximum 1GB',
    'upload.cancel': 'Cancel',
    'upload.uploadCount': 'Upload ({count})',

    // Time
    'time.justNow': 'Just now',
    'time.minutesAgo': 'minutes ago',
    'time.hoursAgo': 'hours ago',
    'time.daysAgo': 'days ago',

    // Filters
    'filters.all': 'All',
    'filters.filename': 'Filename',
    'filters.hash': 'Hash',
    'filters.sampleType': 'Sample Type',
    'filters.labels': 'Labels',
    'filters.dateRange': 'Date Range',
    'filters.sizeRange': 'Size Range',
    'filters.clear': 'Clear Filters',
    'filters.apply': 'Apply Filters',

    // Tabs
    'tabs.files': 'Files',
    'tabs.tree': 'Tree View',
    'tabs.stats': 'Statistics',
    'tabs.overview': 'Overview',
    'tabs.details': 'Details',
    'tabs.results': 'Results',
    'tabs.logs': 'Logs',

    // CFG Management
    'cfg.name': 'Name',
    'cfg.url': 'URL',
    'cfg.enabled': 'Enabled',
    'cfg.status': 'Status',
    'cfg.lastCheck': 'Last Check',
    'cfg.actions': 'Actions',
    'cfg.edit': 'Edit',
    'cfg.healthCheck': 'Health Check',
    'cfg.stats': 'Statistics',
    'cfg.delete': 'Delete',
    'cfg.create': 'Create',
    'cfg.creating': 'Creating...',
    'cfg.description': 'Description',
    'cfg.yes': 'Yes',
    'cfg.no': 'No',
    'cfg.all': 'All',
    'cfg.enabledOnly': 'Show Enabled Only',
    'cfg.totalRecords': 'Total {count} records',
    'cfg.page': 'Page {current} / {total}',
    'cfg.prevPage': 'Previous',
    'cfg.nextPage': 'Next',
    'cfg.newInstance': 'New Instance',
    'cfg.loading': 'Loading...',
    'cfg.fillRequired': 'Please fill in name and URL',
    'cfg.createSuccess': 'Created successfully',
    'cfg.createFailed': 'Creation failed: {error}',
    'cfg.healthCheckSuccess': 'Health check completed',
    'cfg.healthCheckFailed': 'Health check failed: {error}',
    'cfg.deleteConfirm': 'Are you sure you want to delete CFG instance "{name}"?\n\nNote: Deletion will fail if this instance is associated with historical tasks.',
    'cfg.deleteSuccess': 'Deleted successfully',
    'cfg.deleteFailed': 'Deletion failed: {error}',

    // Task Stats
    'taskStats.totalTasks': 'Total Tasks',
    'taskStats.pendingTasks': 'Pending',
    'taskStats.runningTasks': 'Running',
    'taskStats.completedTasks': 'Completed',
    'taskStats.failedTasks': 'Failed',
    'taskStats.completionRate': 'Completion Rate',
    'taskStats.totalSubTasks': 'Total Sub-tasks',
    'taskStats.pendingSubTasks': 'Pending',
    'taskStats.runningSubTasks': 'Running',
    'taskStats.completedSubTasks': 'Completed',
    'taskStats.failedSubTasks': 'Failed',
    'taskStats.loadError': 'Unable to load task statistics',

    // Task Status
    'taskStatus.pending': 'Pending',
    'taskStatus.running': 'Running',
    'taskStatus.paused': 'Paused',
    'taskStatus.completed': 'Completed',
    'taskStatus.failed': 'Failed',
    'taskStatus.cancelled': 'Cancelled',
    'taskStatus.submitting': 'Submitting',
    'taskStatus.submitted': 'Submitted',
    'taskStatus.analyzing': 'Analyzing',
    'taskStatus.unknown': 'Unknown Status',

    // Analyzers
    'analyzer.cape': 'CAPE',
    'analyzer.cfg': 'CFG',
    'analyzer.capeDesc': 'Sandbox Analysis',
    'analyzer.cfgDesc': 'Control Flow Analysis',
    'analyzer.unknown': 'Unknown Analyzer',

    // Sub Tasks
    'subTasks.title': 'Sub-tasks List',
    'subTasks.loading': 'Loading sub-tasks...',
    'subTasks.noData': 'No sub-tasks available',
    'subTasks.copySuccess': '{label} copied to clipboard',
    'subTasks.copyError': 'Clipboard API not available',
    'subTasks.totalRecords': 'Total {total} records, page {page} / {totalPages}',
    'subTasks.status': 'Status',
    'subTasks.sampleName': 'Sample Name',
    'subTasks.type': 'Type',
    'subTasks.instance': 'Instance',
    'subTasks.size': 'Size',
    'subTasks.md5Hash': 'MD5 Hash',
    'subTasks.createdAt': 'Created At',
    'subTasks.actions': 'Actions',
    'subTasks.labels': 'Labels',
    'subTasks.source': 'Source',
    'subTasks.retryCount': 'Retry Count',
    'subTasks.externalTaskId': 'External Task ID',
    'subTasks.none': 'None',
    'subTasks.error': 'Error: {message}',
    'subTasks.viewDetails': 'View Details',
    'subTasks.viewCapeDetails': 'View CAPE Details',
    'subTasks.viewCfgDetails': 'View CFG Details',

    // Advanced Search Filters
    'advancedSearch.title': 'Advanced Search',
    'advancedSearch.collapse': 'Collapse',
    'advancedSearch.expand': 'Expand',
    'advancedSearch.activeFilters': '{count} active filters',
    'advancedSearch.filename': 'Filename (Fuzzy Search)',
    'advancedSearch.filenamePlaceholder': 'Enter filename keywords...',
    'advancedSearch.source': 'Source (Exact Match)',
    'advancedSearch.sourcePlaceholder': 'Enter sample source...',
    'advancedSearch.hashSearch': 'Hash Search',
    'advancedSearch.md5Invalid': 'Invalid MD5 format (requires 32 hex characters)',
    'advancedSearch.sha1Invalid': 'Invalid SHA1 format (requires 40 hex characters)',
    'advancedSearch.sha256Invalid': 'Invalid SHA256 format (requires 64 hex characters)',
    'advancedSearch.md5Placeholder': 'Enter MD5 hash...',
    'advancedSearch.sha1Placeholder': 'Enter SHA1 hash...',
    'advancedSearch.sha256Placeholder': 'Enter SHA256 hash...',
    'advancedSearch.fileType': 'File Type',
    'advancedSearch.fileTypeAll': 'All Types',
    'advancedSearch.fileTypeExecutable': 'Executable',
    'advancedSearch.fileTypeArchive': 'Archive',
    'advancedSearch.fileTypeDocument': 'Document',
    'advancedSearch.fileTypeImage': 'Image',
    'advancedSearch.fileTypeOther': 'Other',
    'advancedSearch.sampleType': 'Sample Type',
    'advancedSearch.sampleTypeAll': 'All Types',
    'advancedSearch.sampleTypeMalicious': 'Malicious',
    'advancedSearch.sampleTypeBenign': 'Benign',
    'advancedSearch.sampleTypeUnknown': 'Unknown',
    'advancedSearch.sizeRange': 'File Size Range',
    'advancedSearch.minSize': 'Min Size (bytes)',
    'advancedSearch.maxSize': 'Max Size (bytes)',
    'advancedSearch.dateRange': 'Upload Date Range',
    'advancedSearch.startDate': 'Start Date',
    'advancedSearch.endDate': 'End Date',
    'advancedSearch.labels': 'Labels (comma separated)',
    'advancedSearch.labelsPlaceholder': 'Enter labels...',
    'advancedSearch.clearAll': 'Clear All',
    'advancedSearch.applyFilters': 'Apply Filters',

    // Task Filters
    'taskFilters.searchPlaceholder': 'Search task name...',
    'taskFilters.running': 'Running',
    'taskFilters.failed': 'Failed',
    'taskFilters.completed': 'Completed',
    'taskFilters.batchTasks': 'Batch Tasks',
    'taskFilters.clearAll': 'Clear All',

    // Sub Task Filters
    'subTaskFilters.allStatus': 'All Status',
    'subTaskFilters.searchRange': 'Search Range',
    'subTaskFilters.smartSearch': 'Smart (Filename/Hash)',
    'subTaskFilters.filename': 'Filename',
    'subTaskFilters.searchByName': 'Search by filename (fuzzy)',
    'subTaskFilters.searchByMd5': 'Search by MD5 (exact)',
    'subTaskFilters.searchBySha1': 'Search by SHA1 (exact)',
    'subTaskFilters.searchBySha256': 'Search by SHA256 (exact)',
    'subTaskFilters.smartPlaceholder': 'Search filename (fuzzy) or hash (exact): supports name / md5 / sha1 / sha256',
    'subTaskFilters.search': 'Search',
    'subTaskFilters.clear': 'Clear',

    // Sample Stats Extended
    'sampleStats.loading': 'Loading statistics...',
    'sampleStats.noData': 'No statistics available',
    'sampleStats.fileTypes': 'File Types',
    'sampleStats.sizeDistribution': 'Size Distribution',
    'sampleStats.sourceDistribution': 'Source Distribution',
    'sampleStats.uploadTrends': 'Upload Trends',
    'sampleStats.fileTypeDistribution': 'File Type Distribution',
    'sampleStats.fileTypeDesc': 'Distribution of file types and sizes in the system',
    'sampleStats.unknown': 'Unknown',
    'sampleStats.filesCount': '{count} files',
    'sampleStats.fileSizeDistribution': 'File Size Distribution',
    'sampleStats.fileSizeDesc': 'Distribution of files by size ranges',
    'sampleStats.sourceDistributionTitle': 'Source Distribution',
    'sampleStats.sourceDesc': 'Distribution of samples by source',
    'sampleStats.uploadTrendTitle': 'Upload Trends',
    'sampleStats.uploadTrendDesc': 'Daily upload statistics for the recent period',
    'sampleStats.date': 'Date',
    'sampleStats.uploads': 'Uploads',

    // Execution Monitor View
    'monitor.activeTasks': 'Active Tasks',
    'monitor.completedTasks': 'Completed Tasks',
    'monitor.failedTasks': 'Failed Tasks',
    'monitor.totalProgress': 'Total Progress',
    'monitor.realTimeMonitor': 'Real-time Monitor',
    'monitor.historyRecord': 'History Record',
    'monitor.noActiveTasks': 'No active tasks',
    'monitor.selectTask': 'Select a task to view details',
    'monitor.taskDetails': 'Task Details',
    'monitor.autoRefresh': 'Auto Refresh',
    'monitor.refresh': 'Refresh',
    'monitor.historyFeature': 'History feature will be implemented in future versions',
    'monitor.executionStatus': 'Execution Status',
    'monitor.progress': 'Progress',
    'monitor.taskId': 'Task ID',
    'monitor.createdAt': 'Created at',

    // File Table
    'fileTable.malicious': 'Malicious',
    'fileTable.benign': 'Benign',
    'fileTable.deleteSuccess': 'File deleted successfully',
    'fileTable.deleteError': 'Delete failed: {message}',
    'fileTable.batchDeleteSuccess': 'Successfully deleted {count} files',
    'fileTable.batchDeletePartial': 'Deletion completed: {success} successful, {failed} failed',
    'fileTable.batchDeleteError': 'Batch delete failed: {message}',
    'fileTable.downloadStart': 'Download started: {filename}',
    'fileTable.downloadError': 'Download failed: {message}',
    'fileTable.confirmDelete': 'Are you sure you want to delete this file? This action cannot be undone.',
    'fileTable.confirmBatchDelete': 'Are you sure you want to delete {count} selected files? This action cannot be undone.',
    'fileTable.loadError': 'Loading failed: {message}',
    'fileTable.retry': 'Retry',
    'fileTable.noData': 'No file data',
    'fileTable.selected': 'Selected {count} files',
    'fileTable.batchDownload': 'Batch Download',
    'fileTable.batchDelete': 'Batch Delete',
    'fileTable.cancelSelection': 'Cancel Selection',
    'fileTable.fileInfo': 'File Info',
    'fileTable.type': 'Type',
    'fileTable.size': 'Size',
    'fileTable.labels': 'Labels',
    'fileTable.hash': 'Hash',
    'fileTable.createdAt': 'Created At',
    'fileTable.actions': 'Actions',
    'fileTable.source': 'Source',
    'fileTable.container': 'Container',
    'fileTable.noLabels': 'No labels',
    'fileTable.viewDetails': 'View Details',
    'fileTable.downloadFile': 'Download File',
    'fileTable.deleteFile': 'Delete File',
    'fileTable.pagination': 'Showing {start} - {end} of {total} records',
    'fileTable.pageSize': 'Items per page:',
    'fileTable.previous': 'Previous',
    'fileTable.next': 'Next',
    'fileTable.batchDownloadTitle': 'Batch Download Settings',
    'fileTable.encryptZip': 'Encrypt ZIP (password required)',
    'fileTable.password': 'Password',
    'fileTable.passwordPlaceholder': 'Enter password',
    'fileTable.downloadInfo': 'Will package {count} files into one ZIP for download.',
    'fileTable.cancel': 'Cancel',
    'fileTable.batchDownloadError': 'Batch download failed',
    'fileTable.startDownload': 'Start Download',

    // File Tree
    'fileTree.filesCount': '{count} files',
    'fileTree.source': 'Source',

    // Task Views
    'taskViews.listView': 'List View',
    'taskViews.monitorView': 'Monitor View',

    // Task Table
    'taskTable.deleteSuccess': 'Task deleted successfully',
    'taskTable.deleteError': 'Delete failed: {message}',
    'taskTable.batchDeleteSuccess': 'Batch delete successful ({count} tasks)',
    'taskTable.batchDeleteError': 'Batch delete failed: {message}',
    'taskTable.confirmBatchDelete': 'Are you sure you want to delete {count} selected tasks?',
    'taskTable.loading': 'Loading task list...',
    'taskTable.loadError': 'Loading failed: {message}',
    'taskTable.retry': 'Retry',
    'taskTable.selected': 'Selected {count} tasks',

    // CAPE Management
    'cape.createSuccess': 'CAPE instance created successfully',
    'cape.createError': 'Creation failed: {message}',
    'cape.updateSuccess': 'CAPE instance updated successfully',
    'cape.updateError': 'Update failed: {message}',
    'cape.deleteSuccess': 'CAPE instance deleted successfully',
    'cape.deleteError': 'Delete failed: {message}',
    'cape.healthCheckSuccess': 'Health check completed: {status}',
    'cape.healthCheckError': 'Health check failed: {message}',
    'cape.healthy': 'Healthy',
    'cape.unhealthy': 'Unhealthy',
    'cape.confirmDelete': 'Are you sure you want to delete CAPE instance "{name}"?\n\nNote: Deletion will fail if this instance is associated with historical tasks.',
    'cape.loadError': 'Loading failed: {message}',
    'cape.totalInstances': 'Total Instances',
    'cape.enabledInstances': 'Enabled Instances',
    'cape.healthyInstances': 'Healthy Instances',
    'cape.unhealthyInstances': 'Unhealthy Instances',
    'cape.instanceList': 'Instance List',
    'cape.instanceListDesc': 'View and manage all CAPE instance configurations',
    'cape.percentage': '{percentage}%',

    // CAPE Instance Dialog
    'capeDialog.nameRequired': 'Instance name cannot be empty',
    'capeDialog.nameTooLong': 'Instance name is too long',
    'capeDialog.apiUrlRequired': 'API address cannot be empty',
    'capeDialog.invalidUrl': 'Please enter a valid URL',
    'capeDialog.urlProtocol': 'URL must start with http:// or https://',
    'capeDialog.descTooLong': 'Description is too long',
    'capeDialog.healthIntervalMin': 'Health check interval cannot be less than 10 seconds',
    'capeDialog.healthIntervalMax': 'Health check interval cannot exceed 1 hour',
    'capeDialog.submitError': 'Submission failed:',
    'capeDialog.editTitle': 'Edit CAPE Instance',
    'capeDialog.createTitle': 'Create CAPE Instance',
    'capeDialog.instanceName': 'Instance Name *',
    'capeDialog.instanceNamePlaceholder': 'Enter instance name, e.g.: CAPE-Main-Instance',
    'capeDialog.instanceNameDesc': 'Friendly name to identify this CAPE instance',
    'capeDialog.apiAddress': 'API Address *',
    'capeDialog.apiAddressPlaceholder': 'http://192.168.1.100:8000/apiv2',
    'capeDialog.apiAddressDesc': 'CAPE API base URL for communication',
    'capeDialog.description': 'Description',
    'capeDialog.descriptionPlaceholder': 'Optional description for this instance',
    'capeDialog.healthCheckInterval': 'Health Check Interval (seconds)',
    'capeDialog.healthCheckIntervalDesc': 'Interval for automatic health checks',
    'capeDialog.enabled': 'Enable Instance',
    'capeDialog.enabledDesc': 'Whether this instance is enabled for task execution',

    // CAPE Instances Table
    'capeTable.loading': 'Loading...',
    'capeTable.noInstances': 'No CAPE instances',
    'capeTable.createFirst': 'Please create the first CAPE instance',
    'capeTable.name': 'Name',
    'capeTable.status': 'Status',
    'capeTable.address': 'Address',
    'capeTable.concurrency': 'Concurrency',
    'capeTable.timeout': 'Timeout',
    'capeTable.responseTime': 'Response Time',

    // Task Detail Page
    'taskDetail.loading': 'Loading task details...',
    'taskDetail.back': 'Back',
    'taskDetail.notFound': 'Unable to load task details. Task may not exist or has been deleted.',
    'taskDetail.taskId': 'Task ID: {id}',
    'taskDetail.refresh': 'Refresh',
    'taskDetail.confirmPause': 'Are you sure you want to pause task "{name}"?\n\nRunning subtasks will complete before stopping, pending subtasks will pause submission.',
    'taskDetail.pauseSuccess': 'Task paused',
    'taskDetail.pauseError': 'Failed to pause task',
    'taskDetail.pauseTask': 'Pause Task',
    'taskDetail.resumeSuccess': 'Task resumed',
    'taskDetail.resumeError': 'Failed to resume task',
    'taskDetail.resumeTask': 'Resume Task',
    'taskDetail.exportResults': 'Export Results',
    'taskDetail.executeAnalyzer': 'Execute {analyzer}',
    'taskDetail.taskPaused': 'Task is paused, please resume first',
    'taskDetail.taskStatus': 'Task Status',
    'taskDetail.statusRunning': 'Running',
    'taskDetail.statusCompleted': 'Completed',
    'taskDetail.statusFailed': 'Failed',
    'taskDetail.statusPending': 'Pending',
    'taskDetail.statusPausedText': 'Task Paused',
    'taskDetail.statusCancelled': 'Cancelled',
    'taskDetail.statusUnknown': 'Unknown Status',
    'taskDetail.analyzer': 'Analyzer',
    'taskDetail.taskType': '{type} type task',
    'taskDetail.executionProgress': 'Execution Progress',
    'taskDetail.samplesCompleted': '{completed}/{total} samples completed',
    'taskDetail.timeInfo': 'Time Information',
    'taskDetail.created': 'Created:',
    'taskDetail.updated': 'Updated:',
    'taskDetail.started': 'Started:',
    'taskDetail.runtime': 'Runtime:',
    'taskDetail.runtimeFormat': '{minutes}min {seconds}s',
    'taskDetail.unknown': 'Unknown',
    'taskDetail.subtaskLoadError': 'Failed to load subtask list, please refresh and try again. Error: {message}',
    'taskDetail.taskConfig': 'Task Configuration',
    'taskDetail.taskConfigDesc': 'Configuration parameters and settings when task was created',
    'taskDetail.taskTypeLabel': 'Task Type',
    'taskDetail.analyzerLabel': 'Analyzer',
    'taskDetail.totalSamples': 'Total Samples',
    'taskDetail.completedSamples': 'Completed',
    'taskDetail.failedSamples': 'Failed Count',
    'taskDetail.sampleFilters': 'Sample Filter Conditions',
    'taskDetail.analysisOverview': 'Analysis Results Overview',
    'taskDetail.analysisOverviewDesc': 'Analysis results and statistics after task completion',
    'taskDetail.loadingResults': 'Loading analysis results...',
    'taskDetail.resultsSummary': 'Results Summary',
    'taskDetail.analysisResults': 'Analysis Results ({count})',
    'taskDetail.score': 'Score: {score}',
    'taskDetail.viewDetails': 'View Details',
    'taskDetail.viewMore': 'View More Results ({count})',
    'taskDetail.noDetailedResults': 'No detailed analysis results available',
    'taskDetail.resultsAfterCompletion': 'Analysis results will be displayed after task completion',
    'taskDetail.resultsLoadError': 'Failed to load analysis results, please refresh and try again. Error: {message}',
    'taskDetail.executionError': 'Task Execution Error: {message}',
    'taskDetail.tabSubtasks': 'Subtasks',
    'taskDetail.tabConfig': 'Configuration',
    'taskDetail.tabResults': 'Results',

    // Sample Detail Dialog
    'sampleDetail.copySuccess': '{label} copied to clipboard',
    'sampleDetail.copyError': 'Copy failed',
    'sampleDetail.maliciousSample': 'Malicious Sample',
    'sampleDetail.benignSample': 'Benign Sample',
    'sampleDetail.containerFile': 'Container File',
    'sampleDetail.fileInfo': 'File Information',
    'sampleDetail.fileHash': 'File Hash',
    'sampleDetail.createdTime': 'Created Time',
    'sampleDetail.labels': 'Labels',
    'sampleDetail.fullHash': 'Full Hash Values',
    'sampleDetail.source': 'Source',
    'sampleDetail.containerInfo': 'Container Information',
    'sampleDetail.passwordProtected': 'Password Protected:',
    'sampleDetail.yes': 'Yes',
    'sampleDetail.no': 'No',
    'sampleDetail.executableFile': 'Executable File:',
    'sampleDetail.hierarchy': 'Hierarchy',
    'sampleDetail.parentFileId': 'Parent File ID:',
    'sampleDetail.zipPath': 'ZIP Path:',
    'sampleDetail.timeInfo': 'Time Information',
    'sampleDetail.createdAt': 'Created:',
    'sampleDetail.updatedAt': 'Updated:',
    'sampleDetail.systemInfo': 'System Information',
    'sampleDetail.sampleId': 'Sample ID:',
    'sampleDetail.storagePath': 'Storage Path:',
    'sampleDetail.customMetadata': 'Custom Metadata:',
    'sampleDetail.customMetadataTitle': 'Custom Metadata',
  },
  'zh-CN': {
    // App
    'app.title': 'SampleFarm - 样本管理系统',
    'app.description': '专业的恶意样本管理和分析平台',

    // Navigation
    'nav.brand': 'SampleFarm',
    'nav.files': '文件管理',
    'nav.files.desc': '上传、管理和查看样本文件',
    'nav.tasks': '任务管理',
    'nav.tasks.desc': '创建和监控分析任务',
    'nav.cape': 'CAPE管理',
    'nav.cape.desc': '配置和监控CAPE沙箱实例',
    'nav.cfg': 'CFG管理',
    'nav.cfg.desc': '配置和监控CFG分析实例',
    'nav.api': 'API 文档',
    'nav.api.download': '下载 API 文档',

    // Language
    'lang.en': 'English',
    'lang.zh': '中文',

    // Common Actions
    'common.refresh': '刷新',
    'common.create': '创建',
    'common.edit': '编辑',
    'common.delete': '删除',
    'common.save': '保存',
    'common.cancel': '取消',
    'common.confirm': '确认',
    'common.close': '关闭',
    'common.search': '搜索',
    'common.filter': '筛选',
    'common.export': '导出',
    'common.import': '导入',
    'common.upload': '上传',
    'common.download': '下载',
    'common.view': '查看',
    'common.details': '详情',
    'common.settings': '设置',
    'common.loading': '加载中...',
    'common.noData': '暂无数据',
    'common.error': '错误',
    'common.success': '成功',
    'common.warning': '警告',
    'common.info': '信息',

    // Pages
    'pages.files.title': '文件管理',
    'pages.files.desc': '管理和分析恶意样本文件',
    'pages.files.upload': '上传文件',
    'pages.tasks.title': '任务管理',
    'pages.tasks.desc': '创建和监控样本分析任务',
    'pages.tasks.create': '创建任务',
    'pages.cape.title': 'CAPE实例管理',
    'pages.cape.desc': '管理和监控CAPE沙箱实例',
    'pages.cape.create': '创建实例',
    'pages.cfg.title': 'CFG实例管理',
    'pages.cfg.desc': '管理和监控CFG分析实例',
    'pages.cfg.create': '创建实例',

    // Stats
    'stats.totalFiles': '总文件数',
    'stats.benignFiles': '安全文件',
    'stats.maliciousFiles': '恶意文件',
    'stats.containerFiles': '容器文件',
    'stats.storageUsed': '存储使用',
    'stats.totalTasks': '总任务数',
    'stats.runningTasks': '运行中',
    'stats.completedTasks': '已完成',
    'stats.failedTasks': '失败',
    'stats.pendingTasks': '等待中',

    // Status
    'status.pending': '等待中',
    'status.running': '运行中',
    'status.completed': '已完成',
    'status.failed': '失败',
    'status.cancelled': '已取消',
    'status.paused': '已暂停',
    'status.active': '活跃',
    'status.inactive': '非活跃',
    'status.online': '在线',
    'status.offline': '离线',
    'status.healthy': '健康',
    'status.unhealthy': '不健康',

    // File Management
    'files.filename': '文件名',
    'files.size': '大小',
    'files.type': '类型',
    'files.hash': '哈希值',
    'files.uploadTime': '上传时间',
    'files.lastModified': '最后修改',
    'files.sampleType': '样本类型',
    'files.labels': '标签',
    'files.source': '来源',
    'files.malicious': '恶意',
    'files.benign': '安全',
    'files.unknown': '未知',
    'files.container': '容器',

    // Task Management
    'tasks.taskId': '任务ID',
    'tasks.taskName': '任务名称',
    'tasks.analyzer': '分析器',
    'tasks.priority': '优先级',
    'tasks.progress': '进度',
    'tasks.createdAt': '创建时间',
    'tasks.updatedAt': '更新时间',
    'tasks.duration': '持续时间',
    'tasks.samples': '样本',
    'tasks.results': '结果',

    // Upload Dialog
    'upload.title': '上传文件',
    'upload.dragDrop': '拖拽文件到此处或点击选择',
    'upload.dragActive': '松开鼠标即可上传',
    'upload.selectFiles': '选择文件',
    'upload.metadata': '元数据',
    'upload.sampleType': '样本类型',
    'upload.labels': '标签',
    'upload.source': '来源',
    'upload.passwords': '密码',
    'upload.uploading': '上传中...',
    'upload.success': '文件上传成功: {filename}',
    'upload.failed': '上传失败: {error}',
    'upload.fileInfo': '文件信息',
    'upload.sampleTypeRequired': '样本类型 *',
    'upload.malicious': '恶意样本',
    'upload.benign': '安全样本',
    'upload.sourceLabel': '来源',
    'upload.sourcePlaceholder': '邮件附件、下载链接等',
    'upload.labelsLabel': '标签',
    'upload.labelsPlaceholder': '输入标签，用逗号分隔',
    'upload.zipPassword': 'ZIP密码 (可选)',
    'upload.zipPasswordPlaceholder': '如果是密码保护的ZIP文件',
    'upload.selectedFiles': '已选择的文件 ({count})',
    'upload.clear': '清空',
    'upload.pending': '待上传',
    'upload.fileTooLarge': '文件 "{filename}" 过大: {size} MB，最大允许 1024 MB',
    'upload.fileRejected': '文件 "{filename}" 被拒绝: {error}',
    'upload.noFiles': '没有待上传的文件',
    'upload.supportedFormats': '支持单文件或ZIP压缩包，最大1GB',
    'upload.cancel': '取消',
    'upload.uploadCount': '上传 ({count})',

    // Time
    'time.justNow': '刚刚',
    'time.minutesAgo': '分钟前',
    'time.hoursAgo': '小时前',
    'time.daysAgo': '天前',

    // Filters
    'filters.all': '全部',
    'filters.filename': '文件名',
    'filters.hash': '哈希值',
    'filters.sampleType': '样本类型',
    'filters.labels': '标签',
    'filters.dateRange': '日期范围',
    'filters.sizeRange': '大小范围',
    'filters.clear': '清除筛选',
    'filters.apply': '应用筛选',

    // Tabs
    'tabs.files': '文件',
    'tabs.tree': '树形视图',
    'tabs.stats': '统计',
    'tabs.overview': '概览',
    'tabs.details': '详情',
    'tabs.results': '结果',
    'tabs.logs': '日志',

    // CFG Management
    'cfg.name': '名称',
    'cfg.url': 'URL',
    'cfg.enabled': '启用',
    'cfg.status': '状态',
    'cfg.lastCheck': '最后检查',
    'cfg.actions': '操作',
    'cfg.edit': '编辑',
    'cfg.healthCheck': '健康检查',
    'cfg.stats': '统计',
    'cfg.delete': '删除',
    'cfg.create': '创建',
    'cfg.creating': '创建中...',
    'cfg.description': '描述',
    'cfg.yes': '是',
    'cfg.no': '否',
    'cfg.all': '全部',
    'cfg.enabledOnly': '仅显示启用',
    'cfg.totalRecords': '共 {count} 条记录',
    'cfg.page': '第 {current} / {total} 页',
    'cfg.prevPage': '上一页',
    'cfg.nextPage': '下一页',
    'cfg.newInstance': '新建实例',
    'cfg.loading': '加载中...',
    'cfg.fillRequired': '请填写名称与URL',
    'cfg.createSuccess': '创建成功',
    'cfg.createFailed': '创建失败: {error}',
    'cfg.healthCheckSuccess': '健康检查已完成',
    'cfg.healthCheckFailed': '健康检查失败: {error}',
    'cfg.deleteConfirm': '确定要删除CFG实例"{name}"吗？\n\n注意：如果该实例关联了历史任务，删除将失败。',
    'cfg.deleteSuccess': '删除成功',
    'cfg.deleteFailed': '删除失败: {error}',

    // Task Stats
    'taskStats.totalTasks': '总任务数',
    'taskStats.pendingTasks': '等待中',
    'taskStats.runningTasks': '执行中',
    'taskStats.completedTasks': '已完成',
    'taskStats.failedTasks': '失败任务',
    'taskStats.completionRate': '完成率',
    'taskStats.totalSubTasks': '总子任务',
    'taskStats.pendingSubTasks': '等待中',
    'taskStats.runningSubTasks': '执行中',
    'taskStats.completedSubTasks': '已完成',
    'taskStats.failedSubTasks': '失败',
    'taskStats.loadError': '无法加载任务统计信息',

    // Task Status
    'taskStatus.pending': '等待中',
    'taskStatus.running': '执行中',
    'taskStatus.paused': '已暂停',
    'taskStatus.completed': '已完成',
    'taskStatus.failed': '失败',
    'taskStatus.cancelled': '已取消',
    'taskStatus.submitting': '提交中',
    'taskStatus.submitted': '已提交',
    'taskStatus.analyzing': '分析中',
    'taskStatus.unknown': '未知状态',

    // Analyzers
    'analyzer.cape': 'CAPE',
    'analyzer.cfg': 'CFG',
    'analyzer.capeDesc': '沙箱分析',
    'analyzer.cfgDesc': '控制流分析',
    'analyzer.unknown': '未知分析器',

    // Sub Tasks
    'subTasks.title': '子任务列表',
    'subTasks.loading': '加载子任务中...',
    'subTasks.noData': '暂无子任务',
    'subTasks.copySuccess': '{label}已复制到剪贴板',
    'subTasks.copyError': '剪贴板API不可用',
    'subTasks.totalRecords': '共 {total} 条记录，第 {page} / {totalPages} 页',
    'subTasks.status': '状态',
    'subTasks.sampleName': '样本名称',
    'subTasks.type': '类型',
    'subTasks.instance': '执行实例',
    'subTasks.size': '大小',
    'subTasks.md5Hash': 'MD5哈希',
    'subTasks.createdAt': '创建时间',
    'subTasks.actions': '操作',
    'subTasks.labels': '标签',
    'subTasks.source': '来源',
    'subTasks.retryCount': '重试次数',
    'subTasks.externalTaskId': '外部任务ID',
    'subTasks.none': '无',
    'subTasks.error': '错误: {message}',
    'subTasks.viewDetails': '查看详情',
    'subTasks.viewCapeDetails': '查看 CAPE 详情',
    'subTasks.viewCfgDetails': '查看 CFG 详情',

    // Advanced Search Filters
    'advancedSearch.title': '高级搜索',
    'advancedSearch.collapse': '收起',
    'advancedSearch.expand': '展开',
    'advancedSearch.activeFilters': '{count} 个活跃筛选',
    'advancedSearch.filename': '文件名（模糊搜索）',
    'advancedSearch.filenamePlaceholder': '输入文件名关键词...',
    'advancedSearch.source': '来源（精确匹配）',
    'advancedSearch.sourcePlaceholder': '输入样本来源...',
    'advancedSearch.hashSearch': '哈希值搜索',
    'advancedSearch.md5Invalid': 'MD5 格式无效（需要32位十六进制字符）',
    'advancedSearch.sha1Invalid': 'SHA1 格式无效（需要40位十六进制字符）',
    'advancedSearch.sha256Invalid': 'SHA256 格式无效（需要64位十六进制字符）',
    'advancedSearch.md5Placeholder': '输入 MD5 哈希值...',
    'advancedSearch.sha1Placeholder': '输入 SHA1 哈希值...',
    'advancedSearch.sha256Placeholder': '输入 SHA256 哈希值...',
    'advancedSearch.fileType': '文件类型',
    'advancedSearch.fileTypeAll': '所有类型',
    'advancedSearch.fileTypeExecutable': '可执行文件',
    'advancedSearch.fileTypeArchive': '压缩文件',
    'advancedSearch.fileTypeDocument': '文档',
    'advancedSearch.fileTypeImage': '图片',
    'advancedSearch.fileTypeOther': '其他',
    'advancedSearch.sampleType': '样本类型',
    'advancedSearch.sampleTypeAll': '所有类型',
    'advancedSearch.sampleTypeMalicious': '恶意',
    'advancedSearch.sampleTypeBenign': '良性',
    'advancedSearch.sampleTypeUnknown': '未知',
    'advancedSearch.sizeRange': '文件大小范围',
    'advancedSearch.minSize': '最小大小（字节）',
    'advancedSearch.maxSize': '最大大小（字节）',
    'advancedSearch.dateRange': '上传日期范围',
    'advancedSearch.startDate': '开始日期',
    'advancedSearch.endDate': '结束日期',
    'advancedSearch.labels': '标签（逗号分隔）',
    'advancedSearch.labelsPlaceholder': '输入标签...',
    'advancedSearch.clearAll': '清空所有',
    'advancedSearch.applyFilters': '应用筛选',

    // Task Filters
    'taskFilters.searchPlaceholder': '搜索任务名称...',
    'taskFilters.running': '执行中',
    'taskFilters.failed': '失败',
    'taskFilters.completed': '已完成',
    'taskFilters.batchTasks': '批量任务',
    'taskFilters.clearAll': '清空所有',

    // Sub Task Filters
    'subTaskFilters.allStatus': '全部状态',
    'subTaskFilters.searchRange': '搜索范围',
    'subTaskFilters.smartSearch': '智能（文件名/哈希）',
    'subTaskFilters.filename': '文件名',
    'subTaskFilters.searchByName': '按文件名搜索（模糊）',
    'subTaskFilters.searchByMd5': '按 MD5 搜索（精确）',
    'subTaskFilters.searchBySha1': '按 SHA1 搜索（精确）',
    'subTaskFilters.searchBySha256': '按 SHA256 搜索（精确）',
    'subTaskFilters.smartPlaceholder': '搜索文件名（模糊）或哈希（精确）：支持 name / md5 / sha1 / sha256',
    'subTaskFilters.search': '搜索',
    'subTaskFilters.clear': '清除',

    // Sample Stats Extended
    'sampleStats.loading': '加载统计数据中...',
    'sampleStats.noData': '暂无统计数据',
    'sampleStats.fileTypes': '文件类型',
    'sampleStats.sizeDistribution': '大小分布',
    'sampleStats.sourceDistribution': '来源分布',
    'sampleStats.uploadTrends': '上传趋势',
    'sampleStats.fileTypeDistribution': '文件类型分布',
    'sampleStats.fileTypeDesc': '系统中各种文件类型的数量和大小分布',
    'sampleStats.unknown': '未知',
    'sampleStats.filesCount': '{count} 个文件',
    'sampleStats.fileSizeDistribution': '文件大小分布',
    'sampleStats.fileSizeDesc': '按大小范围分布的文件统计',
    'sampleStats.sourceDistributionTitle': '来源分布',
    'sampleStats.sourceDesc': '按来源分布的样本统计',
    'sampleStats.uploadTrendTitle': '上传趋势',
    'sampleStats.uploadTrendDesc': '最近一段时间的每日上传统计',
    'sampleStats.date': '日期',
    'sampleStats.uploads': '上传数量',

    // Execution Monitor View
    'monitor.activeTasks': '活跃任务',
    'monitor.completedTasks': '已完成任务',
    'monitor.failedTasks': '失败任务',
    'monitor.totalProgress': '总体进度',
    'monitor.realTimeMonitor': '实时监控',
    'monitor.historyRecord': '历史记录',
    'monitor.noActiveTasks': '暂无活跃任务',
    'monitor.selectTask': '选择一个任务查看详情',
    'monitor.taskDetails': '任务详情',
    'monitor.autoRefresh': '自动刷新',
    'monitor.refresh': '刷新',
    'monitor.historyFeature': '历史记录功能将在后续版本中实现',
    'monitor.executionStatus': '实时执行状态',
    'monitor.progress': '进度',
    'monitor.taskId': '任务ID',
    'monitor.createdAt': '创建于',

    // File Table
    'fileTable.malicious': '恶意',
    'fileTable.benign': '安全',
    'fileTable.deleteSuccess': '文件删除成功',
    'fileTable.deleteError': '删除失败: {message}',
    'fileTable.batchDeleteSuccess': '成功删除 {count} 个文件',
    'fileTable.batchDeletePartial': '删除完成：成功 {success} 个，失败 {failed} 个',
    'fileTable.batchDeleteError': '批量删除失败: {message}',
    'fileTable.downloadStart': '开始下载: {filename}',
    'fileTable.downloadError': '下载失败: {message}',
    'fileTable.confirmDelete': '确定要删除这个文件吗？此操作无法撤销。',
    'fileTable.confirmBatchDelete': '确定要删除选中的 {count} 个文件吗？此操作无法撤销。',
    'fileTable.loadError': '加载失败: {message}',
    'fileTable.retry': '重试',
    'fileTable.noData': '暂无文件数据',
    'fileTable.selected': '已选择 {count} 个文件',
    'fileTable.batchDownload': '批量下载',
    'fileTable.batchDelete': '批量删除',
    'fileTable.cancelSelection': '取消选择',
    'fileTable.fileInfo': '文件信息',
    'fileTable.type': '类型',
    'fileTable.size': '大小',
    'fileTable.labels': '标签',
    'fileTable.hash': '哈希值',
    'fileTable.createdAt': '创建时间',
    'fileTable.actions': '操作',
    'fileTable.source': '来源',
    'fileTable.container': '容器',
    'fileTable.noLabels': '无标签',
    'fileTable.viewDetails': '查看详情',
    'fileTable.downloadFile': '下载文件',
    'fileTable.deleteFile': '删除文件',
    'fileTable.pagination': '显示第 {start} - {end} 条，共 {total} 条记录',
    'fileTable.pageSize': '每页显示:',
    'fileTable.previous': '上一页',
    'fileTable.next': '下一页',
    'fileTable.batchDownloadTitle': '批量下载设置',
    'fileTable.encryptZip': '加密ZIP（需输入密码）',
    'fileTable.password': '密码',
    'fileTable.passwordPlaceholder': '请输入密码',
    'fileTable.downloadInfo': '将把 {count} 个文件打包为一个ZIP下载。',
    'fileTable.cancel': '取消',
    'fileTable.batchDownloadError': '批量下载失败',
    'fileTable.startDownload': '开始下载',

    // File Tree
    'fileTree.filesCount': '{count} 个文件',
    'fileTree.source': '来源',

    // Task Views
    'taskViews.listView': '列表视图',
    'taskViews.monitorView': '监控视图',

    // Task Table
    'taskTable.deleteSuccess': '任务删除成功',
    'taskTable.deleteError': '删除失败: {message}',
    'taskTable.batchDeleteSuccess': '批量删除成功 ({count} 个任务)',
    'taskTable.batchDeleteError': '批量删除失败: {message}',
    'taskTable.confirmBatchDelete': '确定要删除选中的 {count} 个任务吗？',
    'taskTable.loading': '加载任务列表中...',
    'taskTable.loadError': '加载失败: {message}',
    'taskTable.retry': '重试',
    'taskTable.selected': '已选择 {count} 个任务',

    // CAPE Management
    'cape.createSuccess': 'CAPE实例创建成功',
    'cape.createError': '创建失败: {message}',
    'cape.updateSuccess': 'CAPE实例更新成功',
    'cape.updateError': '更新失败: {message}',
    'cape.deleteSuccess': 'CAPE实例删除成功',
    'cape.deleteError': '删除失败: {message}',
    'cape.healthCheckSuccess': '健康检查完成: {status}',
    'cape.healthCheckError': '健康检查失败: {message}',
    'cape.healthy': '健康',
    'cape.unhealthy': '异常',
    'cape.confirmDelete': '确定要删除CAPE实例"{name}"吗？\n\n注意：如果该实例关联了历史任务，删除将失败。',
    'cape.loadError': '加载失败: {message}',
    'cape.totalInstances': '总实例数',
    'cape.enabledInstances': '启用实例',
    'cape.healthyInstances': '健康实例',
    'cape.unhealthyInstances': '异常实例',
    'cape.instanceList': '实例列表',
    'cape.instanceListDesc': '查看和管理所有CAPE实例配置',
    'cape.percentage': '{percentage}%',

    // CAPE Instance Dialog
    'capeDialog.nameRequired': '实例名称不能为空',
    'capeDialog.nameTooLong': '实例名称过长',
    'capeDialog.apiUrlRequired': 'API地址不能为空',
    'capeDialog.invalidUrl': '请输入有效的URL',
    'capeDialog.urlProtocol': 'URL必须以http://或https://开头',
    'capeDialog.descTooLong': '描述过长',
    'capeDialog.healthIntervalMin': '健康检查间隔不能少于10秒',
    'capeDialog.healthIntervalMax': '健康检查间隔不能超过1小时',
    'capeDialog.submitError': '提交失败:',
    'capeDialog.editTitle': '编辑CAPE实例',
    'capeDialog.createTitle': '创建CAPE实例',
    'capeDialog.instanceName': '实例名称 *',
    'capeDialog.instanceNamePlaceholder': '输入实例名称，如：CAPE-主实例',
    'capeDialog.instanceNameDesc': '用于识别此CAPE实例的友好名称',
    'capeDialog.apiAddress': 'API地址 *',
    'capeDialog.apiAddressPlaceholder': 'http://192.168.1.100:8000/apiv2',
    'capeDialog.apiAddressDesc': '用于通信的CAPE API基础URL',
    'capeDialog.description': '描述',
    'capeDialog.descriptionPlaceholder': '此实例的可选描述',
    'capeDialog.healthCheckInterval': '健康检查间隔（秒）',
    'capeDialog.healthCheckIntervalDesc': '自动健康检查的间隔时间',
    'capeDialog.enabled': '启用实例',
    'capeDialog.enabledDesc': '此实例是否启用用于任务执行',

    // CAPE Instances Table
    'capeTable.loading': '加载中...',
    'capeTable.noInstances': '暂无CAPE实例',
    'capeTable.createFirst': '请创建第一个CAPE实例',
    'capeTable.name': '名称',
    'capeTable.status': '状态',
    'capeTable.address': '地址',
    'capeTable.concurrency': '并发数',
    'capeTable.timeout': '超时时间',
    'capeTable.responseTime': '响应时间',

    // Task Detail Page
    'taskDetail.loading': '加载任务详情中...',
    'taskDetail.back': '返回',
    'taskDetail.notFound': '无法加载任务详情。任务可能不存在或已被删除。',
    'taskDetail.taskId': '任务ID: {id}',
    'taskDetail.refresh': '刷新',
    'taskDetail.confirmPause': '确定要暂停任务"{name}"吗？\n\n正在执行的子任务将完成后停止，等待中的子任务将暂停提交。',
    'taskDetail.pauseSuccess': '任务已暂停',
    'taskDetail.pauseError': '暂停任务失败',
    'taskDetail.pauseTask': '暂停任务',
    'taskDetail.resumeSuccess': '任务已恢复',
    'taskDetail.resumeError': '恢复任务失败',
    'taskDetail.resumeTask': '恢复任务',
    'taskDetail.exportResults': '导出结果',
    'taskDetail.executeAnalyzer': '执行{analyzer}',
    'taskDetail.taskPaused': '任务已暂停，请先恢复',
    'taskDetail.taskStatus': '任务状态',
    'taskDetail.statusRunning': '正在执行中',
    'taskDetail.statusCompleted': '已完成',
    'taskDetail.statusFailed': '执行失败',
    'taskDetail.statusPending': '等待执行',
    'taskDetail.statusPausedText': '任务已暂停',
    'taskDetail.statusCancelled': '任务已取消',
    'taskDetail.statusUnknown': '未知状态',
    'taskDetail.analyzer': '分析器',
    'taskDetail.taskType': '{type} 类型任务',
    'taskDetail.executionProgress': '执行进度',
    'taskDetail.samplesCompleted': '{completed}/{total} 样本完成',
    'taskDetail.timeInfo': '时间信息',
    'taskDetail.created': '创建：',
    'taskDetail.updated': '更新：',
    'taskDetail.started': '开始：',
    'taskDetail.runtime': '运行时间：',
    'taskDetail.runtimeFormat': '{minutes}分{seconds}秒',
    'taskDetail.unknown': '未知',
    'taskDetail.subtaskLoadError': '子任务列表加载失败，请刷新页面重试。错误: {message}',
    'taskDetail.taskConfig': '任务配置',
    'taskDetail.taskConfigDesc': '任务创建时的配置参数和设置',
    'taskDetail.taskTypeLabel': '任务类型',
    'taskDetail.analyzerLabel': '分析器',
    'taskDetail.totalSamples': '样本总数',
    'taskDetail.completedSamples': '已完成',
    'taskDetail.failedSamples': '失败数量',
    'taskDetail.sampleFilters': '样本筛选条件',
    'taskDetail.analysisOverview': '分析结果概览',
    'taskDetail.analysisOverviewDesc': '任务执行完成后的分析结果和统计信息',
    'taskDetail.loadingResults': '加载分析结果中...',
    'taskDetail.resultsSummary': '结果摘要',
    'taskDetail.analysisResults': '分析结果 ({count} 个)',
    'taskDetail.score': '评分: {score}',
    'taskDetail.viewDetails': '查看详情',
    'taskDetail.viewMore': '查看更多结果 ({count})',
    'taskDetail.noDetailedResults': '暂无详细分析结果',
    'taskDetail.resultsAfterCompletion': '任务完成后将显示分析结果',
    'taskDetail.resultsLoadError': '分析结果加载失败，请刷新页面重试。错误: {message}',
    'taskDetail.executionError': '任务执行错误：{message}',
    'taskDetail.tabSubtasks': '子任务',
    'taskDetail.tabConfig': '配置',
    'taskDetail.tabResults': '结果',

    // Sample Detail Dialog
    'sampleDetail.copySuccess': '{label} 已复制到剪贴板',
    'sampleDetail.copyError': '复制失败',
    'sampleDetail.maliciousSample': '恶意样本',
    'sampleDetail.benignSample': '安全样本',
    'sampleDetail.containerFile': '容器文件',
    'sampleDetail.fileInfo': '文件信息',
    'sampleDetail.fileHash': '文件哈希',
    'sampleDetail.createdTime': '创建时间',
    'sampleDetail.labels': '标签',
    'sampleDetail.fullHash': '完整哈希值',
    'sampleDetail.source': '来源',
    'sampleDetail.containerInfo': '容器信息',
    'sampleDetail.passwordProtected': '密码保护:',
    'sampleDetail.yes': '是',
    'sampleDetail.no': '否',
    'sampleDetail.executableFile': '运行文件:',
    'sampleDetail.hierarchy': '层级关系',
    'sampleDetail.parentFileId': '父文件ID:',
    'sampleDetail.zipPath': 'ZIP内路径:',
    'sampleDetail.timeInfo': '时间信息',
    'sampleDetail.createdAt': '创建时间:',
    'sampleDetail.updatedAt': '更新时间:',
    'sampleDetail.systemInfo': '系统信息',
    'sampleDetail.sampleId': '样本ID:',
    'sampleDetail.storagePath': '存储路径:',
    'sampleDetail.customMetadata': '自定义元数据:',
    'sampleDetail.customMetadataTitle': '自定义元数据',
  },
}

export function I18nProvider({ children }: { children: React.ReactNode }) {
  const [lang, setLangState] = useState<SupportedLang>('en')

  useEffect(() => {
    try {
      const stored = localStorage.getItem(STORAGE_KEY) as SupportedLang | null
      if (stored === 'en' || stored === 'zh-CN') {
        setLangState(stored)
        return
      }
      // Fallback to browser language once on first load
      const navLang = typeof navigator !== 'undefined' ? navigator.language : 'en'
      setLangState(navLang.startsWith('zh') ? 'zh-CN' : 'en')
    } catch {
      setLangState('en')
    }
  }, [])

  const setLang = useCallback((l: SupportedLang) => {
    setLangState(l)
    try {
      localStorage.setItem(STORAGE_KEY, l)
    } catch {}
  }, [])

  const t = useCallback((key: string, params?: Record<string, string | number>) => {
    const table = messages[lang]
    let message = table[key] ?? key
    
    if (params) {
      Object.entries(params).forEach(([param, value]) => {
        message = message.replace(`{${param}}`, String(value))
      })
    }
    
    return message
  }, [lang])

  const value = useMemo(() => ({ lang, setLang, t }), [lang, setLang, t])

  return (
    <I18nContext.Provider value={value}>
      {children}
    </I18nContext.Provider>
  )
}

export function useI18n() {
  const ctx = useContext(I18nContext)
  if (!ctx) throw new Error('useI18n must be used within I18nProvider')
  return ctx
}


